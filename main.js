$(function () {    //判断页面地址    var pn = window.location.pathname.toLowerCase();    var index = 0;    switch (pn) {        case "/default.html":        case "/default.aspx":            index = 0;            break;        default:            if (pn.indexOf("/outbound/") != -1 || pn.indexOf("/travels/") != -1) {                index = 1;            }            else if (pn.indexOf("/inbound/") != -1) {                index = 1;            }            else if (pn.indexOf("/province/") != -1) {                index = 1;            }            else if (pn.indexOf("/cruise/") != -1) {                index = 1;            }            else if (pn.indexOf("/gangaotai/") != -1) {                index = 1;            }            else if (pn.indexOf("/freetrip/") != -1 || pn.indexOf("/freetrips/") != -1) {                index = 2;            }            else if (pn.indexOf("/groupbuy/") != -1) {                index = 3;            }            else if (pn.indexOf("/hotel/") != -1 || pn.indexOf("/hotels/") != -1) {                index = 4;            }            else if (pn.indexOf("/ticket/") != -1 || pn.indexOf("/tickets/") != -1) {                index = 5;            }            else if (pn.indexOf("/flight/") != -1 || pn.indexOf("/flights/") != -1) {                index = 6;            }            else if (pn.indexOf("/subjects/") != -1) {                index = 7;            }            else if (pn.indexOf("/cars/") != -1) {                index = 8;            }            else if (pn.indexOf("/cooperative/") != -1) {                index = 9;            }            else {                index = 0;            }            break;    }    $("#nav>ul>li:eq(" + index + ")>a").addClass("curr");    //jquery_迷你导航_下拉菜单    var $listWrap = $('.listWrap');    $listWrap.hover(function () {        var $this = $(this);        var $downList = $this.find('.downList');        var index = $this.attr('list_index');        $downList.addClass(index + '_listHover hover');        $('#' + index).show();    }, function () {        var $this = $(this);        var $downList = $this.find('.downList');        var index = $this.attr('list_index');        $downList.removeClass(index + '_listHover hover');        $('#' + index).hide();    });    //输入框提醒字    var $tipsInput = $('.tipsInput');    $tipsInput.focus(function () {        var $this = $(this);        var $default = $this.attr('defaultText');        var val = $this.val();        if ($default == val) { $this.val(""); $this.css("color", "#333"); }    }).blur(function () {        var $this = $(this);        var $default = $this.attr('defaultText');        var val = $this.val();        if (val == "") { $this.val($default); $this.css("color", "#CCC"); }    });    var $searchInput = $('#searchInput');    var $searchPanel = $('#searchPanel');    var $searchLable = $('#searchLable');    var $searchList = $('#searchList');    //搜索框悬浮    $searchPanel.hover(function () {        $searchPanel.addClass('search-panel-fields-selected');    }, function () {        $searchPanel.removeClass('search-panel-fields-selected');        $searchList.hide();    });    //搜索框键入,自动完成    var $hotLine = $('#hotLine');    var $autoComplete = $('#autoComplete');    var keycount = 1;    //搜索框获取焦点    $searchInput.focus(function () {        $searchLable.hide();        $searchList.show();    }).blur(function () {        if ($searchInput.val() == "") {            $searchLable.show();            $hotLine.show();            //$autoComplete.hide();        }    }).keydown(function (event) {        $hotLine.hide();        $autoComplete.show();        $searchInput.unbind("keyup");        $searchInput.bind("keyup", onsearchkeyup);        var charcode = ((event || window.event).keyCode);        if (charcode == 13) {            $("#aspnetForm").attr({ "action": geturl(), "method": "post" }).submit();            //gosearch();            return;        }    });    //    .keyup(function () {    //        $(this).unbind("keyup", onsearchkeyup);    //        var charcode = ((event || window.event).keyCode);    //        onsearchkeyup(charcode, $.trim($(this).val()));    //        //$(this).bind("keyup", onsearchkeyup);    //    });    function onsearchkeyup() {        var isshow = true;        /*if (isshow) {        var charcode = ((event || window.event).keyCode);        if (charcode == 8 || charcode == 16 || charcode == 17 || charcode == 18 || charcode == 32 || charcode == 46 || keycount > 3) {        isshow = true;        keycount = 0;        }        else {        keycount++;        isshow = false;        }        }*/        if (isshow) {            if ($.trim($(this).val()) == "") {                isshow = false;            }        }        if (!isshow) {            $hotLine.show();            $autoComplete.hide();            $("#autoCompleteshow").hide();            return;        }        var tb = $("#tblist");        tb.empty();        var type = gettype();        $.ajax({            url: '/AjaxHandler/AutoComplete.aspx',            type: "post",            async: true,            data: "action=getproductsearch&type=" + type + "&q=" + $(this).val() + "&t=" + Math.random(),            beforeSend: function () { tb.empty(); $("#preloader").show(); },            success: function (data) {                var models = eval("(" + data + ")");                if (models.length > 0) {                    tb.find("tr[name=nodata]").remove();                    var indextr = 0;                    for (var i = 0; i < models.length; i++) {                        var model = models[i];                        if (model != null && model != undefined) {                            if (model.Name != undefined && model.Name != "") {                                if (tb.find("tr[name='" + escape(model.Name) + "']").size() == 0) {                                    tb.append("<tr name='" + escape(model.Name) + "'><td  valign=\"top\"><a href='#' onclick='$(\"#searchInput\").val(\"" + model.Name + "\"); $(\"#autoCompleteshow\").hide();gosearch();'>" + model.Name + "</a></td></tr>");                                    indextr++;                                    if (indextr == 15)                                        break;                                }                            }                        }                    }                }                else {                    if (tb.find("tr").size() == 0)                        tb.append("<tr name='nodata'><td valign=\"top\">找不到相关数据</td></tr>");                }                $("#autoCompleteshow").show("fast", "swing");                $autoComplete.hide();            },            complete: function () {                $("#preloader").hide();            },            error: function (a, b, c) {                if (tb.find("tr").size() == 0)                    tb.append("<tr><td valign=\"top\">找不到相关数据</td></tr>");                $("#autoCompleteshow").show("fast", "swing");                $autoComplete.hide();            }        });    }    //搜索框点击隐藏灰色字    $searchLable.click(function () {        $searchInput.focus();    });    //搜索框下拉菜单    $searchSelectedContent = $('#searchSelectedContent');    $searchTab = $('#searchTab');    $searchLi = $('#searchTab ul li');    $searchSelected = $('#searchSelected');    //搜索框选择框悬浮    $searchSelectedContent.hover(function () {        $searchTab.show();        $searchList.hide();        $searchSelected.addClass('searchSelectedUp');    }, function () {        $searchTab.hide();        $searchSelected.removeClass('searchSelectedUp');    });    //搜索框列表悬浮    $searchLi.hover(function () {        $(this).addClass('selected');    }, function () {        $(this).removeClass('selected');    });    //搜索框列表点击    $searchLi.click(function () {        $searchSelected.text($(this).text());    });    //判断鼠标滚轮上下控制mini导航    /*$_mininavWrap = $('#mininavWrap');    var scrollFunc = function (e) {    e = e || window.event;    if (e.wheelDelta && e.wheelDelta < 0 || e.detail) {//IE/Opera/Chrome    $_mininavWrap.removeClass("fixed");    } else {//Firefox    $_mininavWrap.addClass("fixed");    }    }    if (document.addEventListener) {    document.addEventListener('DOMMouseScroll', scrollFunc, false);    } //W3C    window.onmousewheel = document.onmousewheel = scrollFunc; //IE/Opera/Chrome    */    $("a[name=searcha]").click(function () { $("#searchLable").empty(); $("#searchInput").val($(this).text()); gosearch(); });    //问题显示隐藏    $('.quz').hover(function () {$(this).find('#tms').stop(true, false).fadeIn(300);}, function () { $(this).stop(true, false).find('#tms').fadeOut(300); });    //页头登陆显示    $.ajax({        url: '/Users/AjaxHandler/LoginCheck.aspx',        type: "post",        async: true,        data: "checktype=getinfouser",        success: function (data) {            var models = eval("(" + data + ")");            if (models.UserID > 0) {                $("a[group=nonlogin]").hide();                $("a[group=haslogin]").show();                $("#alogined").html("您好," + models.UserName);                $("#asignout").click(function () {                    $.ajax({                        url: '/Users/AjaxHandler/LoginCheck.aspx',                        type: "post",                        async: true,                        data: "checktype=signout",                        success: function (data) {                            window.location.href = "/default.html";                        },                        error: function (a, b, c) {                        }                    });                });            }            else {                $("a[group=nonlogin]").show();                $("a[group=haslogin]").hide();            }        },        error: function (a, b, c) {        }    });});function setSearchValue(keywords, url) {    $("#searchInput").val(keywords);    $("#ctl00_Body_txt_keyword").val(keywords);    var type = "参团游";    if (url.indexOf("hotel") != -1) {        type = "酒店";    }    else if (url.indexOf("cruise/") != -1) {        type = "邮轮";    }    else if (url.indexOf("freetrip/") != -1 || url.indexOf("freetrips/") != -1) {        type = "自由行";    }    else if (url.indexOf("tickets/") != -1) {        type = "门票";    }    else {        type = "参团游";    }    $("#searchSelected").text(type);    if ($("#searchInput").val() != "")        $("#searchLable").empty();}function geturl(){    var type = gettype();    var folder = "/Travels/";    switch (type) {        case 2:            folder = "/freetrips/";            break;        case 1:            folder = "/hotels/";            break;        case 3:            folder = "/Tickets/";            break;        case 4:            folder = "/Cruise/";            break;        default:            folder = "/Travels/";            break;    }    return folder+ "List.aspx?keywords=" + escape($("#searchInput").val()) + "&key=" + $("#search_id").val();}function gosearch() {        window.location.href = geturl();}function gettype() {    var text = $("#searchSelected").text();    //alert(text);    var type = 0;    switch (text) {        case "自由行":            type = 2;            break;        case "酒店":            type = 1;            break;        case "门票":            type = 3;            break;        case "邮轮":            type = 4;            break;        default:            type = 5;            break;    }    return type;}function CancelCollectRoute(id, teamcode, ordertype) {    $.ajax({        type: "GET",        cache: false,        url: '/Travels/AjaxHandler/AjaxProcess.aspx?action=CancelCollectRoute',        //dataType: "json",        data: "routecode=" + id + "&teamcode=" + teamcode + "&ordertype=" + ordertype,        global: false,        beforeSend: function (XMLHttpRequest) {        },        success: function (data, textStatus) {            alert("取消收藏成功");            $(".collection").html(data);            getDatas(6, 1, true); //旅游订单            getDatas(1, 1, true); //酒店            getDatas(2, 1, true); //门票            getDatas(3, 1, true); //自由行        },        complete: function (XMLHttpRequest, textStatus) {            // console.log("完成");        },        error: function () {            //console.log("错误");            alert("取消收藏失败");        }    });};//设为首页 <a onclick="SetHome(this,window.location)">设为首页</a>function SetHome(obj, vrl) {    try {        obj.style.behavior = 'url(#default#homepage)'; obj.setHomePage(vrl);    }    catch (e) {        if (window.netscape) {            try {                netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");            }            catch (e) {                alert("此操作被浏览器拒绝！\n请在浏览器地址栏输入“about:config”并回车\n然后将 [signed.applets.codebase_principal_support]的值设置为'true',双击即可。");            }            var prefs = Components.classes['@mozilla.org/preferences-service;1'].getService(Components.interfaces.nsIPrefBranch);            prefs.setCharPref('browser.startup.homepage', vrl);        }    }}$(function () {    var $ctyp = $('#ctyp');    var width = 0;    $ctyp.find('a').each(function (i, e) {        width += $(e).outerWidth();    });    $ctyp.css('width', width);    document.onclick = function (e) {        var e = e ? e : window.event;        var tar = e.srcElement || e.target;        if ($(tar).attr('id') == "cty") {            $ctyp.css('visibility', 'visible');        } else {            $ctyp.css('visibility', 'hidden');        }    };});